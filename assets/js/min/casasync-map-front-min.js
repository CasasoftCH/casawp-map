function InfoBox(t){t=t||{},google.maps.OverlayView.apply(this,arguments),this.content_=t.content||"",this.disableAutoPan_=t.disableAutoPan||!1,this.maxWidth_=t.maxWidth||0,this.pixelOffset_=t.pixelOffset||new google.maps.Size(0,0),this.position_=t.position||new google.maps.LatLng(0,0),this.zIndex_=t.zIndex||null,this.boxClass_=t.boxClass||"infoBox",this.boxStyle_=t.boxStyle||{},this.closeBoxMargin_=t.closeBoxMargin||"2px",this.closeBoxURL_=t.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",""===t.closeBoxURL&&(this.closeBoxURL_=""),this.infoBoxClearance_=t.infoBoxClearance||new google.maps.Size(1,1),"undefined"==typeof t.visible&&(t.visible="undefined"==typeof t.isHidden?!0:!t.isHidden),this.isHidden_=!t.visible,this.alignBottom_=t.alignBottom||!1,this.pane_=t.pane||"floatPane",this.enableEventPropagation_=t.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.moveListener_=null,this.contextListener_=null,this.eventListeners_=null,this.fixedWidthSet_=null}var map,markers=[],infowindow=!1,marker;jQuery(function(){"use strict";function t(){var t=new google.maps.LatLng(46.8131873,8.2242101),e=new google.maps.Geocoder;e.geocode({address:"switzerland"},function(t,e){e==google.maps.GeocoderStatus.OK&&(map.setCenter(t[0].geometry.location),map.fitBounds(t[0].geometry.viewport))});var i="SATELLITE"==$("#casasync-map_map").data("map_type")?google.maps.MapTypeId.SATELLITE:google.maps.MapTypeId.ROADMAP,n={center:t,mapTypeId:i,mapTypeControl:!1,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.BOTTOM_CENTER},panControl:!1,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.TOP_RIGHT},scaleControl:!1,streetViewControl:!1};map=new google.maps.Map(document.getElementById("casasync-map_map"),n),s(),google.maps.event.addListenerOnce(map,"tilesloaded",function(){a()})}function e(t){for(var e=0;e<markers.length;e++)markers[e].setMap(t)}function i(){e(null)}function n(){i(),markers=[]}function o(t){infowindow.close(map);var e="";window.casasyncMapOptions&&window.casasyncMapOptions.marker_image&&(e=window.casasyncMapOptions.marker_image),marker=new google.maps.Marker({position:new google.maps.LatLng(t.lat,t.lng),map:map,icon:e}),markers.push(marker),google.maps.event.addListener(marker,"click",function(e){r(t)})}function s(){var t=!1;if(window.casasyncMapOptions&&window.casasyncMapOptions.plugin_url)var t=window.casasyncMapOptions.plugin_url+"assets/img/close.png";var e={pixelOffset:new google.maps.Size(-140,0),closeBoxMargin:"18px 5px 5px 5px",closeBoxURL:t,infoBoxClearance:new google.maps.Size(20,20)};infowindow=new InfoBox(e)}function r(t){var e=$("#casasync-map_map").data("readmore_text"),i=window.casasyncMapOptions.infobox_template?$(window.casasyncMapOptions.infobox_template)[0].outerHTML:!1,n={readMoreText:e},o=!1;window.casasyncMapOptions&&window.casasyncMapOptions.i18n&&(o=window.casasyncMapOptions.i18n);var s={property:t,options:n,i18n:o};Mustache.parse(i);var r=Mustache.render(i,s);infowindow.setContent(r),infowindow.open(map,marker),google.maps.event.addListener(infowindow,"domready",function(){$("#casasync-map_map").trigger("cs_infowindow_open")})}function a(){var t=l(),e=$.ajax({url:t,type:"GET",dataType:"json",data:{casasync_map:!0}}).done(function(t){n(),$.each(t,function(t,e){o(e)})})}function l(){var t=$("#casasync_map_filter").find('li[data-current="1"]'),e=$(t[0]).data("url");return t.each(function(t,i){if(0!=t){var n=$(i).data("url");e=e+"&"+n.substring(n.indexOf("?")+1)}}),e}var $=jQuery;google.maps.event.addDomListener(window,"load",t),$("#casasync_map_filter input").click(function(t){var e=$(this).parent().parent();1==$(e).attr("data-current")?$(e).attr("data-current",0).find("input").prop("checked",!1):$(e).attr("data-current",1).find("input").prop("checked",!0),a()})}),function(t,e){"object"==typeof exports&&exports?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Mustache={})}(this,function(t){function e(t){return"function"==typeof t}function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function n(t,e){return u.call(t,e)}function o(t){return!n(g,t)}function s(t){return String(t).replace(/[&<>"'\/]/g,function(t){return _[t]})}function r(e,n){function s(){if(u&&!g)for(;c.length;)delete d[c.pop()];else c=[];u=!1,g=!1}function r(t){if("string"==typeof t&&(t=t.split(y,2)),!f(t)||2!==t.length)throw new Error("Invalid tags: "+t);_=new RegExp(i(t[0])+"\\s*"),B=new RegExp("\\s*"+i(t[1])),b=new RegExp("\\s*"+i("}"+t[1]))}if(!e)return[];var h=[],d=[],c=[],u=!1,g=!1,_,B,b;r(n||t.tags);for(var L=new p(e),I,C,k,M,T,O;!L.eos();){if(I=L.pos,k=L.scanUntil(_))for(var S=0,P=k.length;P>S;++S)M=k.charAt(S),o(M)?c.push(d.length):g=!0,d.push(["text",M,I,I+1]),I+=1,"\n"===M&&s();if(!L.scan(_))break;if(u=!0,C=L.scan(w)||"name",L.scan(v),"="===C?(k=L.scanUntil(m),L.scan(m),L.scanUntil(B)):"{"===C?(k=L.scanUntil(b),L.scan(x),L.scanUntil(B),C="&"):k=L.scanUntil(B),!L.scan(B))throw new Error("Unclosed tag at "+L.pos);if(T=[C,k,I,L.pos],d.push(T),"#"===C||"^"===C)h.push(T);else if("/"===C){if(O=h.pop(),!O)throw new Error('Unopened section "'+k+'" at '+I);if(O[1]!==k)throw new Error('Unclosed section "'+O[1]+'" at '+I)}else"name"===C||"{"===C||"&"===C?g=!0:"="===C&&r(k)}if(O=h.pop())throw new Error('Unclosed section "'+O[1]+'" at '+L.pos);return l(a(d))}function a(t){for(var e=[],i,n,o=0,s=t.length;s>o;++o)i=t[o],i&&("text"===i[0]&&n&&"text"===n[0]?(n[1]+=i[1],n[3]=i[3]):(e.push(i),n=i));return e}function l(t){for(var e=[],i=e,n=[],o,s,r=0,a=t.length;a>r;++r)switch(o=t[r],o[0]){case"#":case"^":i.push(o),n.push(o),i=o[4]=[];break;case"/":s=n.pop(),s[5]=o[2],i=n.length>0?n[n.length-1][4]:e;break;default:i.push(o)}return e}function p(t){this.string=t,this.tail=t,this.pos=0}function h(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function d(){this.cache={}}var c=Object.prototype.toString,f=Array.isArray||function(t){return"[object Array]"===c.call(t)},u=RegExp.prototype.test,g=/\S/,_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},v=/\s*/,y=/\s+/,m=/\s*=/,x=/\s*\}/,w=/#|\^|\/|>|\{|&|=|!/;p.prototype.eos=function(){return""===this.tail},p.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var i=e[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i},p.prototype.scanUntil=function(t){var e=this.tail.search(t),i;switch(e){case-1:i=this.tail,this.tail="";break;case 0:i="";break;default:i=this.tail.substring(0,e),this.tail=this.tail.substring(e)}return this.pos+=i.length,i},h.prototype.push=function(t){return new h(t,this)},h.prototype.lookup=function(t){var i=this.cache,n;if(t in i)n=i[t];else{for(var o=this,s,r,a=!1;o;){if(t.indexOf(".")>0)for(n=o.view,s=t.split("."),r=0;null!=n&&r<s.length;)r===s.length-1&&null!=n&&(a="object"==typeof n&&n.hasOwnProperty(s[r])),n=n[s[r++]];else null!=o.view&&"object"==typeof o.view&&(n=o.view[t],a=o.view.hasOwnProperty(t));if(a)break;o=o.parent}i[t]=n}return e(n)&&(n=n.call(this.view)),n},d.prototype.clearCache=function(){this.cache={}},d.prototype.parse=function(t,e){var i=this.cache,n=i[t];return null==n&&(n=i[t]=r(t,e)),n},d.prototype.render=function(t,e,i){var n=this.parse(t),o=e instanceof h?e:new h(e);return this.renderTokens(n,o,i,t)},d.prototype.renderTokens=function(t,e,i,n){for(var o="",s,r,a,l=0,p=t.length;p>l;++l)a=void 0,s=t[l],r=s[0],"#"===r?a=this._renderSection(s,e,i,n):"^"===r?a=this._renderInverted(s,e,i,n):">"===r?a=this._renderPartial(s,e,i,n):"&"===r?a=this._unescapedValue(s,e):"name"===r?a=this._escapedValue(s,e):"text"===r&&(a=this._rawValue(s)),void 0!==a&&(o+=a);return o},d.prototype._renderSection=function(t,i,n,o){function s(t){return r.render(t,i,n)}var r=this,a="",l=i.lookup(t[1]);if(l){if(f(l))for(var p=0,h=l.length;h>p;++p)a+=this.renderTokens(t[4],i.push(l[p]),n,o);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)a+=this.renderTokens(t[4],i.push(l),n,o);else if(e(l)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");l=l.call(i.view,o.slice(t[3],t[5]),s),null!=l&&(a+=l)}else a+=this.renderTokens(t[4],i,n,o);return a}},d.prototype._renderInverted=function(t,e,i,n){var o=e.lookup(t[1]);return!o||f(o)&&0===o.length?this.renderTokens(t[4],e,i,n):void 0},d.prototype._renderPartial=function(t,i,n){if(n){var o=e(n)?n(t[1]):n[t[1]];return null!=o?this.renderTokens(this.parse(o),i,n,o):void 0}},d.prototype._unescapedValue=function(t,e){var i=e.lookup(t[1]);return null!=i?i:void 0},d.prototype._escapedValue=function(e,i){var n=i.lookup(e[1]);return null!=n?t.escape(n):void 0},d.prototype._rawValue=function(t){return t[1]},t.name="mustache.js",t.version="2.0.0",t.tags=["{{","}}"];var B=new d;t.clearCache=function(){return B.clearCache()},t.parse=function(t,e){return B.parse(t,e)},t.render=function(t,e,i){return B.render(t,e,i)},t.to_html=function(i,n,o,s){var r=t.render(i,n,o);return e(s)?void s(r):r},t.escape=s,t.Scanner=p,t.Context=h,t.Writer=d}),InfoBox.prototype=new google.maps.OverlayView,InfoBox.prototype.createInfoBoxDiv_=function(){var t,e,i,n=this,o=function(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()},s=function(t){t.returnValue=!1,t.preventDefault&&t.preventDefault(),n.enableEventPropagation_||o(t)};if(!this.div_){if(this.div_=document.createElement("div"),this.setBoxStyle_(),"undefined"==typeof this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(i=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-i.left-i.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),!this.enableEventPropagation_){for(this.eventListeners_=[],e=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],t=0;t<e.length;t++)this.eventListeners_.push(google.maps.event.addDomListener(this.div_,e[t],o));this.eventListeners_.push(google.maps.event.addDomListener(this.div_,"mouseover",function(t){this.style.cursor="default"}))}this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",s),google.maps.event.trigger(this,"domready")}},InfoBox.prototype.getCloseBoxImg_=function(){var t="";return""!==this.closeBoxURL_&&(t="<img",t+=" src='"+this.closeBoxURL_+"'",t+=" align=right",t+=" style='",t+=" position: relative;",t+=" cursor: pointer;",t+=" margin: "+this.closeBoxMargin_+";",t+="'>"),t},InfoBox.prototype.addClickHandler_=function(){var t;""!==this.closeBoxURL_?(t=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(t,"click",this.getCloseClickHandler_())):this.closeListener_=null},InfoBox.prototype.getCloseClickHandler_=function(){var t=this;return function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(t,"closeclick"),t.close()}},InfoBox.prototype.panBox_=function(t){var e,i,n=0,o=0;if(!t&&(e=this.getMap(),e instanceof google.maps.Map)){e.getBounds().contains(this.position_)||e.setCenter(this.position_),i=e.getBounds();var s=e.getDiv(),r=s.offsetWidth,a=s.offsetHeight,l=this.pixelOffset_.width,p=this.pixelOffset_.height,h=this.div_.offsetWidth,d=this.div_.offsetHeight,c=this.infoBoxClearance_.width,f=this.infoBoxClearance_.height,u=this.getProjection().fromLatLngToContainerPixel(this.position_);if(u.x<-l+c?n=u.x+l-c:u.x+h+l+c>r&&(n=u.x+h+l+c-r),this.alignBottom_?u.y<-p+f+d?o=u.y+p-f-d:u.y+p+f>a&&(o=u.y+p+f-a):u.y<-p+f?o=u.y+p-f:u.y+d+p+f>a&&(o=u.y+d+p+f-a),0!==n||0!==o){var g=e.getCenter();e.panBy(n,o)}}},InfoBox.prototype.setBoxStyle_=function(){var t,e;if(this.div_){this.div_.className=this.boxClass_,this.div_.style.cssText="",e=this.boxStyle_;for(t in e)e.hasOwnProperty(t)&&(this.div_.style[t]=e[t]);this.div_.style.WebkitTransform="translateZ(0)","undefined"!=typeof this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+100*this.div_.style.opacity+')"',this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},InfoBox.prototype.getBoxWidths_=function(){var t,e={top:0,bottom:0,left:0,right:0},i=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(t=i.ownerDocument.defaultView.getComputedStyle(i,""),t&&(e.top=parseInt(t.borderTopWidth,10)||0,e.bottom=parseInt(t.borderBottomWidth,10)||0,e.left=parseInt(t.borderLeftWidth,10)||0,e.right=parseInt(t.borderRightWidth,10)||0)):document.documentElement.currentStyle&&i.currentStyle&&(e.top=parseInt(i.currentStyle.borderTopWidth,10)||0,e.bottom=parseInt(i.currentStyle.borderBottomWidth,10)||0,e.left=parseInt(i.currentStyle.borderLeftWidth,10)||0,e.right=parseInt(i.currentStyle.borderRightWidth,10)||0),e},InfoBox.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},InfoBox.prototype.draw=function(){this.createInfoBoxDiv_();var t=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=t.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(t.y+this.pixelOffset_.height)+"px":this.div_.style.top=t.y+this.pixelOffset_.height+"px",this.div_.style.visibility=this.isHidden_?"hidden":"visible"},InfoBox.prototype.setOptions=function(t){"undefined"!=typeof t.boxClass&&(this.boxClass_=t.boxClass,this.setBoxStyle_()),"undefined"!=typeof t.boxStyle&&(this.boxStyle_=t.boxStyle,this.setBoxStyle_()),"undefined"!=typeof t.content&&this.setContent(t.content),"undefined"!=typeof t.disableAutoPan&&(this.disableAutoPan_=t.disableAutoPan),"undefined"!=typeof t.maxWidth&&(this.maxWidth_=t.maxWidth),"undefined"!=typeof t.pixelOffset&&(this.pixelOffset_=t.pixelOffset),"undefined"!=typeof t.alignBottom&&(this.alignBottom_=t.alignBottom),"undefined"!=typeof t.position&&this.setPosition(t.position),"undefined"!=typeof t.zIndex&&this.setZIndex(t.zIndex),"undefined"!=typeof t.closeBoxMargin&&(this.closeBoxMargin_=t.closeBoxMargin),"undefined"!=typeof t.closeBoxURL&&(this.closeBoxURL_=t.closeBoxURL),"undefined"!=typeof t.infoBoxClearance&&(this.infoBoxClearance_=t.infoBoxClearance),"undefined"!=typeof t.isHidden&&(this.isHidden_=t.isHidden),"undefined"!=typeof t.visible&&(this.isHidden_=!t.visible),"undefined"!=typeof t.enableEventPropagation&&(this.enableEventPropagation_=t.enableEventPropagation),this.div_&&this.draw()},InfoBox.prototype.setContent=function(t){this.content_=t,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),"undefined"==typeof t.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+t:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(t)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px","undefined"==typeof t.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+t:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(t))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},InfoBox.prototype.setPosition=function(t){this.position_=t,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},InfoBox.prototype.setZIndex=function(t){this.zIndex_=t,this.div_&&(this.div_.style.zIndex=t),google.maps.event.trigger(this,"zindex_changed")},InfoBox.prototype.setVisible=function(t){this.isHidden_=!t,this.div_&&(this.div_.style.visibility=this.isHidden_?"hidden":"visible")},InfoBox.prototype.getContent=function(){return this.content_},InfoBox.prototype.getPosition=function(){return this.position_},InfoBox.prototype.getZIndex=function(){return this.zIndex_},InfoBox.prototype.getVisible=function(){var t;return t="undefined"==typeof this.getMap()||null===this.getMap()?!1:!this.isHidden_},InfoBox.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},InfoBox.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},InfoBox.prototype.open=function(t,e){var i=this;e&&(this.position_=e.getPosition(),this.moveListener_=google.maps.event.addListener(e,"position_changed",function(){i.setPosition(this.getPosition())})),this.setMap(t),this.div_&&this.panBox_()},InfoBox.prototype.close=function(){var t;if(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListeners_){for(t=0;t<this.eventListeners_.length;t++)google.maps.event.removeListener(this.eventListeners_[t]);this.eventListeners_=null}this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)};